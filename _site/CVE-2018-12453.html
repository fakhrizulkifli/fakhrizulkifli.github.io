<!DOCTYPE html>
<html lang="en">
<head>
    <title>Fakhri Zulkifli</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="blog, accent, , Fakhri Zulkifli, jekyll">
    <meta name="author" content="">
    
    
    
    <meta name="description" content="personal website">
    <link href='https://fonts.googleapis.com/css?family=Inconsolata:400,700' rel='stylesheet' type='text/css'>
    <link rel="alternate" type="application/rss+xml" title="Fakhri Zulkifli RSS" href="/feed.xml" />
    <link rel="stylesheet" href="http://localhost:4000/css/main.css">
    
    
    <!-- Facebook Open Graph -->
    <meta name="og:description" content="personal website">
    <meta name="og:title" content="Fakhri Zulkifli">
    <meta name="og:url" content="http://localhost:4000/CVE-2018-12453.html">
    <meta name="og:type" content="article">
    
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Fakhri Zulkifli">
    <meta name="twitter:description" content="personal website">
    <meta name="twitter:url" content="http://localhost:4000/CVE-2018-12453.html">
    
        <meta name="twitter:image" content="">
    
</head>
<body>
    <div class="wrapper">
        <div class="navbar container">
            <a id="author-name" class="alignable pull-left" href="http://localhost:4000">Fakhri Zulkifli</a>
            <ul class="alignable pull-right navbar-ul">
                
                    
                        <li class="alignable pull-right nav-list"><a target="_blank" href="resume.pdf">Resume</a>
                    
                    
                        </li>
                
                    
                        <li class="alignable pull-right nav-list"><a href="/">About</a>
                    
                    
                        /
                    
                        </li>
                
            </ul>
        </div>
        <div style="clear:both"></div>
        <hr>
        
            <div class="container content">
        
                <p>Exploit Title: Redis 5.0 Denial of Service<br />
Date: 2018-06-13<br />
Exploit Author: Fakhri Zulkifli (@d0lph1n98)<br />
Vendor Homepage: https://redis.io/<br />
Software Link: https://redis.io/download<br />
Version: 5.0<br />
Fixed on: 5.0<br />
CVE : CVE-2018-12453<br />
<br />
Type confusion in the xgroupCommand function in t_stream.c in redis-server in Redis before 5.0 allows remote attackers to cause denial-of-service via an XGROUP command in which the key is not a stream.<br />
<br />
<br />
@@ -1576,7 +1576,7 @@ NULL<br />
    	/* Lookup the key now, this is common for all the subcommands but HELP. */<br />
    	if (c-&gt;argc &gt;= 4) {<br />
		robj *o = lookupKeyWriteOrReply(c,c-&gt;argv[2],shared.nokeyerr);<br /></p>
<ul>
  <li>if (o == NULL) return;<br /></li>
  <li>if (o == NULL || checkType(c,o,OBJ_STREAM)) return;<br />
        	s = o-&gt;ptr;<br />
        	grpname = c-&gt;argv[3]-&gt;ptr;<br />
<br />
<br />
#0 0x6d0706 in logStackContent /home/user/redis/src/debug.c:732:45<br />
#1 0x6d3917 in sigsegvHandler /home/user/redis/src/debug.c:1089:5<br />
#2 0x7f65d736e38f  (/lib/x86_64-linux-gnu/libpthread.so.0+0x1138f)<br />
#3 0x804afc in streamLookupCG /home/user/redis/src/t_stream.c:1502:12<br />
#4 0x805b36 in xgroupCommand /home/user/redis/src/t_stream.c:1584:19<br />
#5 0x58ded7 in call /home/user/redis/src/server.c:2298:5<br />
#6 0x591c70 in processCommand /home/user/redis/src/server.c:2580:9<br />
#7 0x5e2d98 in processInputBuffer /home/user/redis/src/networking.c:1325:17<br />
#8 0x565612 in aeProcessEvents /home/user/redis/src/ae.c:443:17<br />
#9 0x56614c in aeMain /home/user/redis/src/ae.c:501:9<br />
#10 0x59da71 in main /home/user/redis/src/server.c:3992:5<br />
#11 0x7f65d6d9d82f in __libc_start_main /build/glibc-Cl5G7W/glibc-2.23/csu/../csu/libc-start.c:291<br />
#12 0x43da38 in _start (/home/user/redis/src/redis-server+0x43da38)<br /></li>
</ul>

				
            </div>
    </div>
    
</body>
<footer>
</footer>
